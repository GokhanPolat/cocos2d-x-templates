

function _copy() {
    script_dir=$(cd $(dirname ${BASH_SOURCE:-$0}); pwd)
    xcode_template_path="/Applications/Xcode.app/Contents/Developer/Library/Xcode/Templates/File Templates/cocos2d-x"

    echo $'\e[32mCopy template files into xcode template directory\e[m' 1>&2

    echo $'\e[33mMake sure create a directory below (and if you have already, remove it before copy files).\e[m' 1>&2
    echo "  $xcode_template_path" 1>&2

    read -p $'\e[32mContinue (y/n)?\e[m' choice
    case "$choice" in
        y|Y ) echo "yes";;
        n|N ) echo "Aborted"; exit;;
        * ) echo "Aborted"; exit;;
    esac

    echo $'\e[32mAlso needs a permission for root user, if you trust me, please enter your password\e[m' 1>&2

    sudo rm -rf "$xcode_template_path"
    sudo mkdir -p "$xcode_template_path"

    echo $'\e[34mStart to copy files\e[m'
    ls | grep xctemplate | sed | while read dir; do
        echo "  $dir"
        sudo mkdir -p "$xcode_template_path/$dir"
        sudo cp -r "$script_dir/../$dir" "$xcode_template_path"
    done
    echo $'\e[34mFinish\e[m'
}

function _clean() {
    script_dir=$(cd $(dirname ${BASH_SOURCE:-$0}); pwd)
    xcode_template_path="/Applications/Xcode.app/Contents/Developer/Library/Xcode/Templates/File Templates/cocos2d-x"

    echo $'\e[32mRemove all template files which are generated by this script\e[m' 1>&2

    echo $'\e[33mMake sure remove a directory below\e[m' 1>&2
    echo $xcode_template_path 1>&2

    read -p "Continue (y/n)?" choice
    case "$choice" in
        y|Y ) echo "yes";;
        n|N ) echo "Aborted"; exit;;
        * ) echo "Aborted"; exit;;
    esac

    echo $'\e[32mAlso needs a permission for root user, if you trust me, please enter your password\e[m' 1>&2

    sudo rm -rf "$xcode_template_path"
}


##-----------------------------------------------
# main
##-----------------------------------------------
if [ -z $1 ]; then
    _copy
else
    "_$1"
fi
